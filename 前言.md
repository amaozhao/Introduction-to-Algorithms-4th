# 前言

不久前，任何听说过“算法”这个词的人几乎可以肯定是计算机科学家或数学家。然而，随着计算机在我们的现代生活中变得普遍，这个术语不再是深奥的。如果你环顾你的家，你会发现算法在最平凡的地方运行：你的微波炉、你的洗衣机，当然还有你的电脑。你要求算法向你提出建议：你可能喜欢什么音乐或开车时要走什么路线。无论好坏，我们的社会都要求算法为已定罪的罪犯提出判决建议。你甚至可以依靠算法来维持生命，或者至少不会杀死你：汽车或医疗设备中的控制系统。^1^“算法”这个词似乎每天都出现在新闻的某个地方。
因此，不仅作为计算机科学的学生或从业者，而且作为世界公民，理解算法是理所当然的。一旦你理解了算法，你就可以教育其他人什么是算法，它们是如何运作的，以及它们的局限性是什么。
本书全面介绍了计算机算法的现代研究。它介绍了许多算法并进行了相当深入的介绍，同时使所有级别的读者都可以访问它们的设计。所有的分析都列出来了，有些简单，有些更复杂。我们试图在不牺牲覆盖深度或数学严谨性的情况下保持解释的清晰。
每章介绍一种算法、一种设计技术、一个应用领域或一个相关主题。算法是用英语和一个伪代码描述的，该伪代码被设计为任何做过一点编程的人都可以阅读。这本书包含 231 个图形——其中许多包含多个部分——说明了算法的工作原理。由于我们强调效率作为设计标准，因此我们对算法的运行时间进行了仔细分析。
本书主要用于算法或数据结构的本科或研究生课程。因为它讨论了算法设计中的工程问题以及数学方面的问题，所以它同样非常适合技术专业人员自学。
在第四版中，我们再次更新了整本书。这些变化涵盖了广泛的范围，包括新的章节和章节、彩色插图，以及我们希望你会发现的更具吸引力的写作风格。
## 给老师

我们设计的这本书既通用又完整。你应该会发现它对各种课程都很有用，从数据结构的本科课程到算法的研究生课程。因为我们提供的材料比典型的一学期课程要多得多，所以你可以选择最能支持你希望教授的课程的材料。
你应该会发现围绕你需要的章节组织课程很容易。我们使章节相对独立，因此你不必担心一章对另一章的意外和不必要的依赖。而在本科课程中，你可能只使用一章中的一些部分，而在研究生课程中，你可能会涵盖整个章节。
我们已经包括了 931 个练习和 162 个问题。每个部分以练习结束，每章以问题结束。练习通常是简短的问题，测试对材料的基本掌握情况。有些是简单的自我检查思维练习，但许多是实质性的，适合作为分配的家庭作业。这些问题包括更复杂的案例研究，这些案例研究通常会引入新材料。它们通常由几个部分组成，引导学生完成获得解决方案所需的步骤。
与本书的第三版一样，我们为一些（但绝不是全部）问题和练习提供了公开的解决方案。你可以在我们的网站 http://mitpress.mit.edu/algorithms/ 上找到这些解决方案。你将需要检查该站点以查看它是否包含你计划分配的练习或问题的解决方案。由于我们发布的解决方案集可能会随着时间的推移而增加，因此我们建议你在每次教授课程时查看该网站。
我们为研究生而不是本科生更适合的部分和练习加了星号（★）。加星标的部分不一定比未加星标的部分更难，但它可能需要了解更高级的数学。同样，加星标的练习可能需要高级背景或高于平均水平的创造力。

## 给学生

我们希望这本教科书为你提供对算法领域的愉快介绍。我们试图让每一个算法都变得容易理解和有趣。为了在你遇到不熟悉或困难的算法时为你提供帮助，我们将逐步描述每个算法。我们还仔细解释了理解算法分析所需的数学知识和支持数据，以帮助你可视化正在发生的事情。
由于这本书很大，你的课程可能只涵盖其中的一部分内容。尽管我们希望这本书现在作为课程教科书对你有所帮助，但我们也努力使其足够全面，以保证你未来的专业书架上的空间。
读这本书的前提是什么？

- 你需要一些编程经验。特别是，你应该了解递归过程和简单的数据结构，例如数组和链表（尽管第 10.2 节介绍了链表和你可能会发现新的变体）。
- 你应该对数学证明有一定的了解，尤其是数学归纳证明。本书的一些部分依赖于一些初等微积分的知识。尽管本书自始至终都使用数学，但第一部分和附录 A-D 会教给你所有你需要的数学技巧。

我们的网站 http://mitpress.mit.edu/algorithms/ 链接到一些问题和练习的解决方案。请随时对照我们的解决方案检查你的解决方案。但是，我们要求你不要将解决方案发送给我们。

## 给专业人士

本书涵盖的广泛主题使其成为一本出色的算法手册。因为每一章都是相对独立的，你可以专注于与你最相关的主题。
由于我们讨论的大多数算法都具有很大的实用性，因此我们解决了实现问题和其他工程问题。我们经常为主要具有理论意义的少数算法提供实用的替代方案。
如果你希望实现任何算法，你应该发现将我们的伪代码翻译成你最喜欢的编程语言是一项相当简单的任务。我们设计了伪代码以清晰简洁地呈现每个算法。因此，我们不解决需要对你的编程环境进行特定假设的错误处理和其他软件工程问题。我们试图简单直接地呈现每个算法，而不会让特定编程语言的特性掩盖其本质。如果你习惯于从 0 开始的数组，你可能会发现我们从 1 开始索引数组的频繁做法是一个小绊脚石。你总是可以从我们的索引中减去 1，或者只是过度分配数组并将位置 0 保留为未使用。
我们知道，如果你在课程之外使用本书，那么你可能无法根据讲师提供的解决方案检查你的问题解决方案和练习。我们的网站 http://mitpress.mit.edu/algorithms/ 链接到一些问题和练习的解决方案，以便你检查你的工作。请不要将你的解决方案发送给我们。

## 致我们的同事

我们提供了广泛的参考书目和当前文献的指针。每章都以一组章节注释结束，这些注释提供了历史细节和参考资料。然而，章节注释并未提供对整个算法领域的完整参考。尽管对于这么大的书可能很难相信，但空间限制使我们无法包含许多有趣的算法。
尽管学生们对问题和练习的解决方案提出了无数要求，但我们采取了不为他们引用参考资料的政策，消除了学生寻找解决方案而不是自己发现解决方案的诱惑。

## 第四版的改动

正如我们所说的第二版和第三版的变化，这取决于你如何看待它，这本书变化不大或相当大。快速浏览目录可以发现，第三版的大部分章节和章节出现在第四版中。我们删除了三个章节和几个部分，但除了这些新章节之外，我们还添加了三个新章节和几个新部分。
我们保留了前三个版本的混合组织。本书不是仅按问题领域或仅根据技术来组织章节，而是结合了两者的元素。它包含基于技术的章节，包括分治法、动态规划、贪心算法、摊销分析、扩充数据结构、NP 完备性和近似算法。但它也有关于排序、动态集的数据结构和图问题的算法的完整部分。我们发现，尽管你需要知道如何应用技术来设计和分析算法，但问题很少向你说明哪些技术最适合解决它们。
第四版中的一些变化普遍适用于全书，而一些变化则针对特定的章节或章节。以下是最重要的一般变化的摘要：

- 我们增加了 140 个新练习和 22 个新问题。我们还改进了许多旧的练习和问题，这通常是读者反馈的结果。 （感谢所有提出建议的读者。）
- 我们有颜色！与麻省理工学院出版社的设计师一起，我们选择了一个有限的调色板，旨在传达信息并赏心悦目。 （我们很高兴在索引中显示红黑树——得到这个——红色和黑色！）为了提高可读性，索引中的定义术语、伪代码注释和页码是彩色的。
- 伪代码过程出现在棕褐色背景上，以便更容易发现，它们不一定出现在第一次参考的页面上。如果他们不这样做，则文本会将你定向到相关页面。同样，对编号方程、定理、引理和推论的非本地引用包括页码。
- 我们删除了很少教授的主题。我们完全放弃了关于斐波那契堆、van Emde Boas 树和计算几何的章节。此外，删除了以下材料：最大子数组问题，实现指针和对象，完美哈希，随机构建的二叉搜索树，拟阵，最大流的推重标记算法，迭代快速傅里叶变换方法，细节用于线性规划和整数分解的单纯形算法。你可以在我们的网站 http://mitpress.mit.edu/algorithms/ 上找到所有已删除的材料。
- 我们审阅了整本书并重写了句子、段落和章节，以使写作更清晰、更个性化和性别中立。例如，以前版本中的“旅行商问题”现在称为“旅行商问题”。我们相信，对于工程和科学，包括我们自己的计算机科学领域，欢迎所有人是至关重要的。 （难倒我们的一个地方是第 13 章，它需要一个术语来表示父母的兄弟姐妹。因为英语没有这样的中性术语，我们很遗憾地坚持使用“叔叔”。）
- 更新了章节注释、参考书目和索引，反映了自第三版以来算法领域的迅猛发展。
- 我们更正了错误，并在我们的第三版勘误网站上发布了大部分更正。在我们全力准备此版本时报告的内容未发布，但在此版本中进行了更正。 （再次感谢所有帮助我们发现问题的读者。）

第四版的具体改动如下：

- 在深入研究正式定义之前，我们重命名了第 3 章并添加了一个概述渐近符号的部分。
- 第 4 章进行了重大修改，以改进其数学基础，使其更加健壮和直观。引入了算法重复的概念，并且更严格地解决了在重复中忽略地板和天花板的主题。主定理的第二种情况包含多对数因子，现在提供了主定理的“连续”版本的严格证明。我们还介绍了强大且通用的 Akra-Bazzi 方法（无需证明）。
- 第 9 章中的确定性顺序统计算法略有不同，对随机和确定性顺序统计算法的分析都进行了改进。
- 除了堆栈和队列之外，10.1 节还讨论了存储数组和矩阵的方法。
- 第 11 章关于哈希表包括对哈希函数的现代处理。当底层硬件实现缓存以支持本地搜索时，它还强调线性探测作为解决冲突的有效方法。
- 为了替换第 15 章中关于拟阵的部分，我们将第三版中关于离线缓存的问题转换为完整部分。
- 第 16.4 节现在包含对分析表加倍和减半的潜在功能的更直观的解释。
- 第 17 章关于增强数据结构的内容从第三部分移至第五部分，反映了我们认为这种技术超越了基础材料的观点。
- 第 25 章是关于二分图中匹配的新章节。它提出了寻找最大基数匹配、解决稳定婚姻问题和寻找最大权重匹配（称为“分配问题”）的算法。
- 第 26 章，关于任务并行计算，已使用现代术语进行了更新，包括章节名称。
- 第 27 章涵盖了在线算法，是另一个新的章节。在在线算法中，输入随着时间的推移到达，而不是在算法开始时全部可用。本章描述了几个在线算法的例子，包括确定在上楼梯前等待电梯的时间、通过移动到前面的启发式维护一个链表，以及评估缓存的替换策略。
- 在第 29 章中，我们删除了单纯形算法的详细介绍，因为它的数学很重，没有真正传达很多算法思想。本章现在关注如何将问题建模为线性规划的关键方面，以及线性规划的基本对偶属性。
- 第 32.5 节在字符串匹配的章节中添加了简单但功能强大的后缀数组结构。
- 第 33 章，关于机器学习，是第三个新章节。它介绍了机器学习中使用的几种基本方法：聚类以将相似的项目组合在一起、加权多数算法和梯度下降以找到函数的最小值。
- 第 34.5.6 节总结了多项式时间缩减的策略，以表明问题是 NP 难的。
- 对第 35.3 节中集合覆盖问题的近似算法的证明进行了修订。

## 网站

你可以使用我们的网站 http://mitpress.mit.edu/algorithms/ 获取补充信息并与我们交流。该网站链接到已知错误列表、第三版中未包含在第四版中的材料、选定练习和问题的解决方案、本书中许多算法的 Python 实现、解释陈词滥调教授笑话的列表（当然），以及我们可能添加的其他内容。该网站还告诉你如何报告错误或提出建议。
## 我们如何制作这本书

与前三个版本一样，第四版是用 LATEX 2~ε~ 制作的。我们使用 Times 字体和数学排版，使用 MathTime Professional II 字体。与之前的所有版本一样，我们使用我们编写的 C 程序 Windex 编译索引，并使用 BIBTEX 生成参考书目。本书的 PDF 文件是在运行 macOS 10.14 的 MacBook Pro 上创建的。
我们在第三版前言中向 Apple 提出的更新 MacDraw Pro for macOS 10 的请求落空了，因此我们继续在旧版 macOS 10 的 Classic 环境下运行 MacDraw Pro 的英特尔之前的 Mac 上绘制插图。插图中出现的数学表达式是在 LATEX 2~ε~ 的 psfrag 包中放置的。

## 第四版致谢

自 1987 年我们开始编写第一版以来，我们一直与麻省理工学院出版社合作，与几位导演、编辑和制作人员合作。在我们与麻省理工学院出版社的整个合作过程中，他们的支持一直非常出色。特别感谢我们的编辑 Marie Lee，她忍受了我们太久，还有 Elizabeth Swayze 把我们推到了终点线。还要感谢导演 Amy Brand 和 Alex Hoopes。
与第三版一样，我们在制作第四版时在地理上分布，在达特茅斯学院计算机科学系工作；麻省理工学院计算机科学与人工智能实验室和麻省理工学院电气工程与计算机科学系；以及哥伦比亚大学工业工程与运筹学系、计算机科学系和数据科学研究所。在 COVID-19 大流行期间，我们主要在家工作。我们感谢我们各自的大学和同事提供了这样的支持和激励的环境。当我们完成本书时，我们这些未退休的人都渴望回到我们各自的大学，因为大流行似乎正在消退。
P.P.A. 的朱莉·苏斯曼 (Julie Sussman) 在巨大的时间压力下以她的技术编辑再次帮助我们。如果不是朱莉，这本书将充满错误（或者，比方说，错误多得多）并且可读性要差得多。朱莉，我们将永远感激你。留下的错误由作者负责（可能是在朱莉阅读材料后插入的）。
在创建此版本的过程中更正了先前版本中的数十处错误。我们感谢我们的读者——太多了，无法一一列举——他们多年来报告了错误并提出了改进建议。
在准备本版中的一些新材料时，我们得到了相当大的帮助。 Neville Campbell（非附属机构）、麻省理工学院的 Bill Kuszmaul 和纽约大学的 Chee Yap 在第 4 章中就复发的治疗提供了宝贵的建议。加州大学河滨分校的 Yan Gu 在第 26 章中提供了有关并行算法的反馈。微软研究院通过他对第 33 章的详细评论改变了我们对机器学习材料的处理方式。麻省理工学院的 Qi Qi 帮助分析了蒙蒂霍尔问题（问题 C-1）。
麻省理工学院出版社的 Molly Seaman 和 Mary Reilly 帮助我们选择了插图中的调色板，达特茅斯学院的 Wojciech Jarosz 建议对我们新着色的人物进行设计改进。毕业于达特茅斯学院的 Yichen (Annie) Ke 和 Linda Xiao 帮助为插图着色，Linda 还制作了许多 Python 实现，可在本书的网站上找到。
最后，我们感谢我们的妻子——Wendy Leiserson、Gail Rivest、Rebecca Ivry 和已故的 Nicole Cormen——以及我们的家人。那些爱我们的人的耐心和鼓励使这个项目成为可能。我们深情地将这本书献给他们。

托马斯·H·科门
黎巴嫩，新罕布什尔州
查尔斯·E·莱瑟森
马萨诸塞州剑桥
罗纳德·里维斯
马萨诸塞州剑桥
克利福德斯坦
纽约，纽约
2021 年 6 月

- 1 要了解算法影响我们日常生活的许多方式，请参阅 Fry 的书 [162]。